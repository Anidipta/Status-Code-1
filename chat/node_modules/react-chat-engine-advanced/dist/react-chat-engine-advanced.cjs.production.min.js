"use strict";function e(e){return e&&"object"==typeof e&&"default"in e?e.default:e}Object.defineProperty(exports,"__esModule",{value:!0});var t=e(require("axios")),n=require("react"),r=e(n),a=require("react-grid-system"),o=e(require("lodash")),i=require("@ant-design/icons"),s=require("react-scroll"),l=require("nextjs-websocket"),c=function(e,n,r,a,o){t.get(e+"/chats/"+r+"/messages/latest/"+a+"/",{headers:n}).then((function(e){o(r,e.data)})).catch((function(e){console.log("Fetch Latest Messages Error",e)}))},u=function(e,n,r,a,o){if(r){var i=new FormData;if(a.attachments.length>0)for(var s=0;s<a.attachments.length;s++)i.append("attachments",a.attachments[s].blob,a.attachments[s].file);null!==a.text&&i.append("text",a.text),i.append("created",a.created),i.append("sender_username",a.sender_username),i.append("custom_json",JSON.stringify({})),t.post(e+"/chats/"+r+"/messages/",i,{headers:n}).then((function(e){o&&o(e.data)})).catch((function(e){console.log("New Message Error",e)}))}},d=function(e,n,r,a,o){t.patch(e+"/chats/"+r+"/people/",{last_read:a},{headers:n}).then((function(e){o&&o(e.data)})).catch((function(e){console.log("Read Message Error",e)}))},p=function(e,n,r,a){t.get(e+"/chats/"+r+"/",{headers:n}).then((function(e){a&&a(e.data)})).catch((function(e){console.log("Get Chat Error",e)}))},h=function(e,n,r,a){t.delete(e+"/chats/"+r+"/",{headers:n}).then((function(e){a&&a(e.data)})).catch((function(e){console.log("Delete Chat Error",e)}))},f=function(e,n,r,a,o){t.put(e+"/chats/latest/"+a+"/",{before:r},{headers:n}).then((function(e){o(e.data)})).catch((function(e){console.log("Fetch Chats Before Error",e)}))},m=function(e,n,r,a){r&&t.post(e+"/chats/",{title:r},{headers:n}).then((function(e){a&&a(e.data)})).catch((function(e){console.log("New Chat Error",e)}))},g=function(e,n,r,a){t.get(e+"/chats/"+r+"/others/",{headers:n}).then((function(e){a(e.data)})).catch((function(e){console.log("Fetch People to Invite Error",e)}))},y=function(e,n,r,a,o){t.post(e+"/chats/"+r+"/people/",{username:a},{headers:n}).then((function(e){o&&o(e.data)})).catch((function(e){console.log("Invite Person Error",e)}))},v=function(e,n,r,a,o){t.put(e+"/chats/"+r+"/people/",{username:a},{headers:n}).then((function(e){o&&o(e.data)})).catch((function(e){console.log("Remove Person Error",e)}))};function x(){x=function(){return e};var e={},t=Object.prototype,n=t.hasOwnProperty,r="function"==typeof Symbol?Symbol:{},a=r.iterator||"@@iterator",o=r.asyncIterator||"@@asyncIterator",i=r.toStringTag||"@@toStringTag";function s(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{s({},"")}catch(e){s=function(e,t,n){return e[t]=n}}function l(e,t,n,r){var a=Object.create((t&&t.prototype instanceof d?t:d).prototype),o=new E(r||[]);return a._invoke=function(e,t,n){var r="suspendedStart";return function(a,o){if("executing"===r)throw new Error("Generator is already running");if("completed"===r){if("throw"===a)throw o;return{value:void 0,done:!0}}for(n.method=a,n.arg=o;;){var i=n.delegate;if(i){var s=w(i,n);if(s){if(s===u)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if("suspendedStart"===r)throw r="completed",n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r="executing";var l=c(e,t,n);if("normal"===l.type){if(r=n.done?"completed":"suspendedYield",l.arg===u)continue;return{value:l.arg,done:n.done}}"throw"===l.type&&(r="completed",n.method="throw",n.arg=l.arg)}}}(e,n,o),a}function c(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}e.wrap=l;var u={};function d(){}function p(){}function h(){}var f={};s(f,a,(function(){return this}));var m=Object.getPrototypeOf,g=m&&m(m(k([])));g&&g!==t&&n.call(g,a)&&(f=g);var y=h.prototype=d.prototype=Object.create(f);function v(e){["next","throw","return"].forEach((function(t){s(e,t,(function(e){return this._invoke(t,e)}))}))}function S(e,t){var r;this._invoke=function(a,o){function i(){return new t((function(r,i){!function r(a,o,i,s){var l=c(e[a],e,o);if("throw"!==l.type){var u=l.arg,d=u.value;return d&&"object"==typeof d&&n.call(d,"__await")?t.resolve(d.__await).then((function(e){r("next",e,i,s)}),(function(e){r("throw",e,i,s)})):t.resolve(d).then((function(e){u.value=e,i(u)}),(function(e){return r("throw",e,i,s)}))}s(l.arg)}(a,o,r,i)}))}return r=r?r.then(i,i):i()}}function w(e,t){var n=e.iterator[t.method];if(void 0===n){if(t.delegate=null,"throw"===t.method){if(e.iterator.return&&(t.method="return",t.arg=void 0,w(e,t),"throw"===t.method))return u;t.method="throw",t.arg=new TypeError("The iterator does not provide a 'throw' method")}return u}var r=c(n,e.iterator,t.arg);if("throw"===r.type)return t.method="throw",t.arg=r.arg,t.delegate=null,u;var a=r.arg;return a?a.done?(t[e.resultName]=a.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,u):a:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,u)}function b(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function C(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function E(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(b,this),this.reset(!0)}function k(e){if(e){var t=e[a];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var r=-1,o=function t(){for(;++r<e.length;)if(n.call(e,r))return t.value=e[r],t.done=!1,t;return t.value=void 0,t.done=!0,t};return o.next=o}}return{next:M}}function M(){return{value:void 0,done:!0}}return p.prototype=h,s(y,"constructor",h),s(h,"constructor",p),p.displayName=s(h,i,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===p||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,h):(e.__proto__=h,s(e,i,"GeneratorFunction")),e.prototype=Object.create(y),e},e.awrap=function(e){return{__await:e}},v(S.prototype),s(S.prototype,o,(function(){return this})),e.AsyncIterator=S,e.async=function(t,n,r,a,o){void 0===o&&(o=Promise);var i=new S(l(t,n,r,a),o);return e.isGeneratorFunction(n)?i:i.next().then((function(e){return e.done?e.value:i.next()}))},v(y),s(y,i,"Generator"),s(y,a,(function(){return this})),s(y,"toString",(function(){return"[object Generator]"})),e.keys=function(e){var t=[];for(var n in e)t.push(n);return t.reverse(),function n(){for(;t.length;){var r=t.pop();if(r in e)return n.value=r,n.done=!1,n}return n.done=!0,n}},e.values=k,E.prototype={constructor:E,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(C),!e)for(var t in this)"t"===t.charAt(0)&&n.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function r(n,r){return i.type="throw",i.arg=e,t.next=n,r&&(t.method="next",t.arg=void 0),!!r}for(var a=this.tryEntries.length-1;a>=0;--a){var o=this.tryEntries[a],i=o.completion;if("root"===o.tryLoc)return r("end");if(o.tryLoc<=this.prev){var s=n.call(o,"catchLoc"),l=n.call(o,"finallyLoc");if(s&&l){if(this.prev<o.catchLoc)return r(o.catchLoc,!0);if(this.prev<o.finallyLoc)return r(o.finallyLoc)}else if(s){if(this.prev<o.catchLoc)return r(o.catchLoc,!0)}else{if(!l)throw new Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return r(o.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var a=this.tryEntries[r];if(a.tryLoc<=this.prev&&n.call(a,"finallyLoc")&&this.prev<a.finallyLoc){var o=a;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var i=o?o.completion:{};return i.type=e,i.arg=t,o?(this.method="next",this.next=o.finallyLoc,u):this.complete(i)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),u},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),C(n),u}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var a=r.arg;C(n)}return a}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,n){return this.delegate={iterator:k(e),resultName:t,nextLoc:n},"next"===this.method&&(this.arg=void 0),u}},e}function S(e,t,n,r,a,o,i){try{var s=e[o](i),l=s.value}catch(e){return void n(e)}s.done?t(l):Promise.resolve(l).then(r,a)}function w(e){return function(){var t=this,n=arguments;return new Promise((function(r,a){var o=e.apply(t,n);function i(e){S(o,r,a,i,s,"next",e)}function s(e){S(o,r,a,i,s,"throw",e)}i(void 0)}))}}function b(){return(b=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}var C={position:"relative",height:"100%"},E={height:"100%",overflowY:"scroll"},k={height:"100%",overflowY:"scroll",borderRight:"1px solid #afafaf",borderLeft:"1px solid #afafaf"},M={height:"100%",overflowY:"scroll"},L={position:"absolute",top:"12px",left:"12px"},F={position:"absolute",top:"12px",right:"12px"},N={width:"100%",height:"100%",maxHeight:"100vh",overflowY:"scroll",overflowX:"hidden",backgroundColor:"white"},I={fontFamily:"Avenir",textAlign:"center",backgroundColor:"#e2e2e2",margin:"4px",paddingTop:"14px",paddingBottom:"14px",borderRadius:"4px"},T={position:"relative",height:"64px",width:"100%",backgroundColor:"white"},A={position:"absolute",top:"16px",left:"14px",fontSize:"26px",fontFamily:"Avenir",fontWeight:600},_={position:"absolute",top:"15px",left:"14px",width:"calc(100% - 28px)"},O={position:"absolute",top:"15px",right:"14px",fontFamily:"Avenir",fontWeight:600},D={style:{fontFamily:"Avenir",color:"#1890ff",border:"1px solid #1890ff",outline:"none",height:"36px",fontSize:"15px",cursor:"pointer",padding:"8px 16px",borderRadius:"33px",backgroundColor:"white",transition:"all .44s ease",WebkitTransition:"all .44s ease",MozTransition:"all .44s ease"},hoveredStyle:{opacity:"0.73"}},z=function(e){var t=e.type,a=void 0===t?"default":t,o=n.useState(!1),i=o[0],s=o[1];return r.createElement("button",{onClick:e.onClick,className:"ce-"+a+"-button "+e.className,onMouseEnter:function(){return s(!0)},onMouseLeave:function(){return s(!1)},style:b({},D.style,"primary"==a?R:"danger"===a?P:{},i?D.hoveredStyle:{},e.style,i?e.hoveredStyle:{})},e.children)},R={color:"white",border:"none",backgroundColor:"#1890ff"},P={color:"#f5222d",backgroundColor:"white",border:"1px solid #f5222d"},B={style:{fontFamily:"Avenir",height:"36px",fontSize:"15px",outline:"none",borderRadius:"24px",border:"1px solid #d9d9d9",padding:"0px 12px",boxSizing:"border-box",transition:"all .33s ease",WebkitTransition:"all .33s ease",MozTransition:"all .33s ease"},focusStyle:{border:"1px solid #1890ff"}},H=function(e){var t=n.useRef(!1),a=n.useState(""),o=a[0],i=a[1],s=n.useState(!1),l=s[0],c=s[1];return n.useEffect((function(){t.current||(t.current=!0,e.defaultValue&&(e.onChange&&e.onChange({target:{value:o}}),i(e.defaultValue)))})),r.createElement("input",{autoFocus:e.autoFocus,className:"ce-input ce-text-input "+e.className,placeholder:e.label,value:"string"==typeof e.value?e.value:o,onChange:function(t){i(t.target.value),e.onChange&&e.onChange(t)},onFocus:function(t){c(!0),e.onFocus&&e.onFocus(t)},onBlur:function(t){c(!1),e.onBlur&&e.onBlur(t)},style:b({},B.style,l?B.focusStyle:{},e.style,l?e.focusStyle:{})})},U=function(e){var t=n.useState(!1),a=t[0],o=t[1],i=n.useState(""),s=i[0],l=i[1];return e.renderChatForm?r.createElement(r.Fragment,null,e.renderChatForm(e)):r.createElement("div",{className:"ce-chat-form",style:b({},T,e.style)},r.createElement("span",{className:"ce-chat-form-title",style:b({},A,e.titleStyle)},"My Chats"),r.createElement(z,{style:b({},O,e.buttonStyle),className:"ce-chat-form-button",onClick:function(){return o(!0)}},"+"),r.createElement("form",{className:"ce-chat-form-html-form",onSubmit:function(t){t.preventDefault(),e.onFormSubmit&&e.onFormSubmit(s),l("")}},r.createElement(H,{autoFocus:!0,value:s,label:"Chat Title",className:"ce-chat-form-input",style:b({},_,{visibility:a?"visible":"hidden"},e.inputStyle),onChange:function(e){l(e.target.value)},onBlur:function(){return o(!1)}})))},W=["#D64045","#5B3000","#00CC99","#467599","#1D3354","#8F250C","#6153CC","#961D4E","#A29F15","#0CAADC","#FF5154","#FA7921","#688E26","#550527","#A10702","#FF1053","#6C6EA0","#100B00"],j=function(e){return e?W[function(e){for(var t=0,n=0;n<e.length;n++)t+=e.charCodeAt(n);return t}(e)%W.length]:"black"},G={position:"relative",width:"44px",height:"44px",borderRadius:"50%",backgroundRepeat:"no-repeat",backgroundPosition:"center",backgroundSize:"48px",color:"white",textAlign:"center",fontFamily:"Avenir",fontSize:"15px",lineHeight:"44px",fontWeight:600},K={position:"absolute",top:"0px",right:"0px",width:"8px",height:"8px",borderRadius:"100%",border:"2px solid white"},Y=function(e){var t=n.useState(""),a=t[0],o=t[1],i=e.username,s=void 0===i?"":i,l=e.avatarUrl,c=void 0===l?"":l,u=s?s.substring(0,2).toUpperCase():"",d=j(s);return n.useEffect((function(){var e=null!==c?c:"";e.split("?")[0]!==a.split("?")[0]&&o(e)})),r.createElement("div",{className:"ce-avatar "+e.className,onClick:e.onClick,style:b({},G,{backgroundColor:a.length>0?"#FFFFFF":d,backgroundImage:a.length>0&&"url("+a+")"},e.style)},0===a.length&&u,r.createElement("div",{className:"ce-avatar-status",style:b({},K,{display:void 0===e.isOnline?"none":"auto",backgroundColor:e.isOnline?"#52c41a":"#f5222d"},e.statusStyle)}))},q={style:{position:"relative",height:"76px",borderRadius:"12px",cursor:"pointer",transition:"all .44s ease",WebkitTransition:"all .44s ease",MozTransition:"all .44s ease"},hoveredStyle:{backgroundColor:"#f5f5f5",border:"0px solid white"},activeStyle:{backgroundColor:"#d9d9d9",border:"0px solid white"},avatarStyle:{position:"absolute",top:"16px",left:"12px"},titleStyle:{position:"absolute",top:"12px",left:"68px",width:"calc(100% - 68px - 32px)",fontWeight:500,whiteSpace:"nowrap",overflow:"hidden",fontFamily:"Avenir"},notificationStyle:{position:"absolute",top:"calc(12px + 6px)",right:"12px",width:"12px",height:"12px",borderRadius:"6px",backgroundColor:"#1890ff",float:"right"},subtitleStyle:{position:"absolute",bottom:"12px",left:"68px",width:"calc(70% - 68px)",color:"rgba(153, 153, 153, 1)",fontSize:"14px",whiteSpace:"nowrap",overflow:"hidden",fontFamily:"Avenir"},timeStampStyle:{position:"absolute",bottom:"12px",right:"12px",width:"20%",textAlign:"right",color:"rgba(153, 153, 153, 1)",fontSize:"14px",whiteSpace:"nowrap",overflow:"hidden",fontFamily:"Avenir"},loadingBarStyle:{borderRadius:"4px",backgroundColor:"#e2e2e2",color:"#e2e2e2"}},V=function(e){var t=e.title,a=void 0===t?"":t,o=e.description,i=void 0===o?"":o,s=e.timeStamp,l=void 0===s?"":s,c=n.useState(!1),u=c[0],d=c[1],p=e.isLoading?b({},q.loadingBarStyle,e.loadingBarStyle):{},h=e.hasNotification?{}:{display:"none"};return e.renderChatCard?r.createElement(r.Fragment,null,e.renderChatCard(e)):r.createElement("div",{onClick:e.onClick,onMouseEnter:function(){return d(!0)},onMouseLeave:function(){return d(!1)},style:b({},q.style,u?q.hoveredStyle:{},e.isActive?q.activeStyle:{},e.style,u?e.hoveredStyle:{},e.isActive?e.activeStyle:{}),className:"\n        ce-chat-card \n        "+(e.isActive&&"ce-active-chat-card")+" \n        "+(u&&"ce-hovered-chat-card")+"\n      "},e.renderAvatar?e.renderAvatar(e):r.createElement(Y,{username:e.avatarUsername,avatarUrl:e.avatarUrl,className:"ce-chat-card-avatar",style:b({},q.avatarStyle,{backgroundColor:e.isLoading?"#e2e2e2":j(e.avatarUsername)},e.avatarStyle)}),r.createElement("div",{className:"ce-chat-card-title "+(e.isLoading&&"ce-chat-card-title-loading ce-chat-card-loading"),style:b({},q.titleStyle,p,e.titleStyle),id:"ce-chat-card-title-"+a},e.isLoading?".":a),r.createElement("div",{className:"ce-chat-card-unread "+(e.isLoading&&"ce-chat-card-unread-loading ce-chat-card-loading"),style:b({},q.notificationStyle,h,p,e.notificationStyle)}),r.createElement("div",{className:"ce-chat-card-subtitle "+(e.isLoading&&"ce-chat-card-subtitle-loading ce-chat-card-loading"),style:b({},q.subtitleStyle,p,e.subtitleStyle)},r.createElement("div",{className:"ce-chat-card-subtitle-html "+(e.isLoading&&"ce-chat-card-subtitle-html-loading ce-chat-card-loading"),dangerouslySetInnerHTML:{__html:e.isLoading?".":i}}),r.createElement("style",null,"p {margin-block-start: 0px; margin-block-end: 0px;}")),r.createElement("div",{className:"ce-chat-card-time-stamp "+(e.isLoading&&"ce-chat-card-time-stamp-loading ce-chat-card-loading"),style:b({},q.timeStampStyle,p,e.timeStampStyle)},e.isLoading?".":l))},J={fontFamily:"Avenir"},X=function(e){var t=e.children,a=void 0===t?"Loading...":t,o=n.useRef(null);return null!==o&&function(t){var r=n.useState(!1)[1],a=new IntersectionObserver((function(t){var n=t[0];r(n.isIntersecting),n.isIntersecting?e.onShow&&e.onShow():e.onHide&&e.onHide()}));n.useEffect((function(){return a.observe(t.current),function(){return a.disconnect()}}),[])}(o),r.createElement("div",{ref:o,style:b({},J,e.style),className:"ce-chat-loader"},a)},Z=function(e,t){void 0===t&&(t=0);var n=(e=e.replace(/ /g,"T")).substr(0,4),r=e.substr(5,2),a=e.substr(8,2),o=e.substr(11,2),i=e.substr(14,2),s=e.substr(17,2),l=new Date(n+"-"+r+"-"+a+"T"+o+":"+i+":"+s);return l.setHours(l.getHours()+t),l};function Q(e){var t=e.toLocaleString("en-US");return t.split(" ")[1].slice(0,-3)+" "+t.slice(-2)}function $(e){return e.toLocaleString("en-US")}var ee={width:"1em",height:"1em"},te=function(e){return r.createElement("svg",{viewBox:"0 0 1024 1024",focusable:"false","aria-hidden":"true",className:"ce-spinner",style:b({},ee,e.style)},r.createElement("path",{d:"M988 548c-19.9 0-36-16.1-36-36 0-59.4-11.6-117-34.6-171.3a440.45 440.45 0 00-94.3-139.9 437.71 437.71 0 00-139.9-94.3C629 83.6 571.4 72 512 72c-19.9 0-36-16.1-36-36s16.1-36 36-36c69.1 0 136.2 13.5 199.3 40.3C772.3 66 827 103 874 150c47 47 83.9 101.8 109.7 162.7 26.7 63.1 40.2 130.2 40.2 199.3.1 19.9-16 36-35.9 36z"}),r.createElement("style",null,"\n      .ce-spinner {\n        animation-name: spin;\n        animation-duration: 950ms;\n        animation-iteration-count: infinite;\n        animation-timing-function: linear; \n      }\n      @keyframes spin {\n        from { transform:rotate(0deg); }\n        to { transform:rotate(360deg); }\n      }\n      "))},ne=function(e){return e.last_message.id?null===e.last_message.text?e.last_message.attachments.length+" attachments":e.last_message.text:"Say hello!"},re=function(e){var t=e.activeChatId,n=void 0===t?-1:t;return e.renderChatList?r.createElement(r.Fragment,null,e.renderChatList(e)):r.createElement("div",{className:"ce-chat-list",style:b({},N,e.isLoading?{overflowY:"hidden"}:{},e.style)},r.createElement(U,{onFormSubmit:e.onChatFormSubmit,renderChatForm:e.renderChatForm}),e.isLoading?[1,1,1,1,1,1,1,1,1,1,1,1].map((function(e,t){return r.createElement(V,{key:"chat_"+t,isLoading:!0})})):e.chats.map((function(t,a){var o,i=t&&t.people.find((function(t){return t.person.username!==e.username})),s=t?t.is_direct_chat&&i?i.person.username:t.title:"",l=Z(t.created,e.timezoneOffset).toString().substr(4,6),c=!!e.username&&!function(e,t){return t.people.some((function(n){return n.person.username===e&&n.last_read===t.last_message.id}))}(e.username,t);return r.createElement(V,{key:"chat_"+a,chat:t,title:s,description:ne(t),timeStamp:l,isActive:n===t.id,hasNotification:c,onClick:function(){return e.onChatCardClick&&e.onChatCardClick(t.id)},avatarUsername:null==(o=t.last_message.sender)?void 0:o.username,avatarUrl:t.last_message.sender?t.last_message.sender.avatar:"https://chat-engine-assets.s3.amazonaws.com/empty-chat-thumb.png",renderChatCard:e.renderChatCard})})),e.hasMoreChats&&r.createElement(X,{onShow:e.onChatLoaderShow,style:b({},I,e.loadingMoreChatsStyle),children:r.createElement(te,null)}))},ae={height:"100%",position:"relative",backgroundColor:"white"},oe={},ie={height:"calc(100% - 85px - 48px)",overflowY:"scroll",overflowX:"hidden",position:"relative",backgroundColor:"white"},se={width:"100%",position:"absolute",bottom:"0px"},le={width:"100%",zIndex:1,backgroundColor:"rgb(256, 256, 256, 0.92)",padding:"18px 0px",textAlign:"center",color:"rgb(24, 144, 255)",overflowX:"hidden"},ce={width:"100%",fontFamily:"Avenir",fontSize:"24px",fontWeight:600},ue={width:"100%",fontFamily:"Avenir",fontSize:"12px"},de={width:"100%",top:"32px",textAlign:"center",color:"rgb(24, 144, 255)",overflow:"hidden"};a.setConfiguration({maxScreenClass:"xl",gutterWidth:0});var pe=function(e){var t=e.id,n=void 0===t?"":t,o=e.title,i=void 0===o?"":o,s=e.description,l=void 0===s?"":s;return e.renderChatHeader?r.createElement(r.Fragment,null,e.renderChatHeader(e)):r.createElement(a.Row,{className:"ce-chat-header",style:b({},le,e.style)},r.createElement(a.Col,{xs:2,sm:0,className:"ce-chat-header-mobile-option",style:b({},de,{left:"6px"},e.mobileOptionStyle)}),r.createElement("div",{id:"ce-chat-feed-title-"+n,className:"ce-chat-header-title",style:b({},ce,e.titleStyle)},i),r.createElement("div",{className:"ce-chat-header-subtitle",style:b({},ue,e.subtitleStyle)},l),r.createElement(a.Col,{xs:2,sm:0,className:"ce-chat-header-mobile-option",style:b({},de,{right:"6px"},e.mobileOptionStyle)}))},he={},fe={},me={style:{width:"100%",position:"relative"},senderUsernameStyle:{width:"calc(100% - 64px)",fontFamily:"Avenir",paddingLeft:"62px",paddingBottom:"2px",color:"rgba(0, 0, 0, .40)",fontSize:"15px"},attachmentsStyle:{display:"auto",paddingLeft:"48px",width:"calc(100% - 48px)"},bodyStyle:{position:"relative",width:"calc(100% - 2px)"},timeTagStyle:{marginLeft:"4px",fontSize:"14px",fontFamily:"Avenir",color:"rgba(0, 0, 0, 0.4)",transition:"all .15s ease",WebkitTransition:"all .15s ease",MozTransition:"all .15s ease"},bubbleStyle:{cursor:"pointer",display:"inline-block",color:"black",padding:"12px",marginLeft:"48px",fontSize:"15px",fontFamily:"Avenir",whiteSpace:"pre-line",backgroundColor:"#f1f0f0",overflowWrap:"anywhere",maxWidth:"calc(100% - 100px - 48px)",transition:"all .33s ease",WebkitTransition:"all .33s ease",MozTransition:"all .33s ease"},readsStyle:{marginLeft:"48px",width:"calc(100% - 50px)"},readStyle:{marginLeft:"4px",float:"left"},avatarStyle:{position:"absolute",bottom:"0px",left:"2px"}},ge={style:{width:"100%",textAlign:"right"},senderUsernameStyle:{display:"none"},attachmentsStyle:{display:"auto",marginLeft:"48px",width:"calc(100% - 48px)"},bodyStyle:{position:"relative",width:"calc(100% - 2px)"},timeTagStyle:{marginRight:"4px",fontSize:"14px",fontFamily:"Avenir",color:"rgb(24, 144, 255)",transition:"all .15s ease",WebkitTransition:"all .15s ease",MozTransition:"all .15s ease"},bubbleStyle:{color:"white",display:"inline-block",backgroundColor:"#1890ff",cursor:"pointer",textAlign:"left",padding:"12px",fontSize:"15px",fontFamily:"Avenir",whiteSpace:"pre-line",overflowWrap:"anywhere",maxWidth:"calc(100% - 100px)",transition:"all .33s ease",WebkitTransition:"all .33s ease",MozTransition:"all .33s ease"},readsStyle:{width:"100%"},readStyle:{float:"right",marginLeft:"4px"},avatarStyle:{display:"none"}},ye={borderRadius:"13px",textAlign:"center",backgroundRepeat:"no-repeat",backgroundPosition:"center",backgroundSize:"14px",transition:"all .33s ease",WebkitTransition:"all .33s ease",MozTransition:"all .33s ease"},ve=function(e){var t=n.useState(""),a=t[0],o=t[1],i=e.username,s=e.isVisible,l=void 0===s||s,c=e.avatarUrl,u=void 0===c?"":c,d=j(void 0===i?"":i);return n.useEffect((function(){var e=null!==u?u:"";e.split("?")[0]!==a.split("?")[0]&&o(e)})),r.createElement("div",{className:"ce-avatar-dot",style:b({},ye,{backgroundColor:a.length>0?"white":d,backgroundImage:a.length>0?"url("+a+")":"",width:l?"13px":"0px",height:l?"13px":"0px"},e.style)})},xe={width:"100%",fontFamily:"Avenir",textAlign:"center",paddingTop:"4px",paddingBottom:"10px",fontSize:"15px",color:"rgba(0, 0, 0, .40)"},Se=function(e){var t=e.offset,n=void 0===t?0:t;return r.createElement("div",{className:"ce-message-date-text",style:b({},xe,e.style)},$(Z(e.created,n)))},we={style:{cursor:"pointer",fontFamily:"Avenir",padding:"12px",borderRadius:"14px",display:"inline-block",marginRight:"2px",marginBottom:"4px",color:"#434343",backgroundColor:"white",border:"1px solid #434343",transition:"all .33s ease",WebkitTransition:"all .33s ease",MozTransition:"all .33s ease"},hoveredStyle:{border:"1px solid #1890ff"}},be=["jpg","jpeg","png","gif","tiff"],Ce=function(e){var t=e.split(".");return t.length>0&&-1!==be.indexOf(t[t.length-1].toLowerCase())},Ee=function(e){var t=e.split("/");return t[t.length-1].split("?")[0]},ke=function(e){var t,a=n.useState(!1),o=a[0],i=a[1];return r.createElement("div",{onMouseEnter:function(){return i(!0)},onMouseLeave:function(){return i(!1)},onClick:function(){return e.url&&"undefined"!=typeof window&&window.open(e.url)},style:b({},we.style,e.url?{}:{border:"1px solid grey"},o?we.hoveredStyle:{},e.style,o?e.hoveredStyle:{}),className:"ce-file "+e.className},e.fileName?e.fileName:"📄 "+((t=e.url)?Ee(t):"Loading..."))},Me={style:{cursor:"pointer",height:"30vw",width:"30vw",maxHeight:"200px",maxWidth:"200px",minHeight:"100px",minWidth:"100px",padding:"2px",objectFit:"cover",borderRadius:"0.3em",backgroundColor:"white",border:"1px solid #434343",transition:"all .33s ease",WebkitTransition:"all .33s ease",MozTransition:"all .33s ease"},hoveredStyle:{border:"1px solid #1890ff"}},Le=function(e){var t=e.url,a=n.useState(!1),o=a[0],i=a[1],s="https://chat-engine-assets.s3.amazonaws.com/loading.gif";return r.createElement("img",{onMouseEnter:function(){return i(!0)},onMouseLeave:function(){return i(!1)},src:t||s,alt:t||s,onClick:function(){return t&&"undefined"!=typeof window&&window.open(t)},style:b({},Me.style,o?Me.hoveredStyle:{},e.style,o?e.hoveredStyle:{}),className:"ce-image "+e.className})},Fe=function(e){var t=e.lastMessage,a=void 0===t?null:t,o=e.message,i=e.nextMessage,s=void 0===i?null:i,l=e.chat,c=void 0===l?null:l,u=e.isSending,d=void 0!==u&&u,p=e.isMyMessage,h=void 0!==p&&p,f=e.showDateTime,m=void 0!==f&&f,g=n.useState(!1),y=g[0],v=g[1],x=h?ge:me,S=a&&a.sender_username===o.sender_username?"0.3em":"1.3em",w=s&&s.sender_username===o.sender_username?"0.3em":"1.3em",C={borderRadius:h?"1.3em "+S+" "+w+" 1.3em":S+" 1.3em 1.3em "+w},E=d?{backgroundColor:"#40a9ff"}:{},k=!s||s.sender_username!==o.sender_username,M=s&&s.sender_username===o.sender_username?"2px":"12px",L=null!==o.text?o.text.replace(/<a /g,"<a style=\"color: 'white';\" "):"",F=function(t){return(o&&o.attachments?o.attachments:[]).map((function(n,a){var o=Ee(n.file);return t&&Ce(o)?r.createElement(Le,{key:"attachment_"+a,url:null===n.file||e.isSending?void 0:n.file,style:b({},x.attachmentsImageStyle,e.attachmentsImageStyle),className:"ce-message-image"}):t||Ce(o)?r.createElement("div",{key:"attachment_"+a}):r.createElement(ke,{key:"attachment_"+a,url:null===n.file||e.isSending?void 0:n.file,style:b({},x.attachmentsFileStyle,e.attachmentsFileStyle),className:"ce-message-file"})}))};return e.renderMessage?r.createElement(r.Fragment,null,e.renderMessage(e)):r.createElement("div",{className:"ce-"+(h?"my":"their")+"-message",style:b({},x.style,{paddingBottom:M},e.style)},m&&r.createElement(Se,{created:o.created,style:b({},x.dateTimeStyle,e.dateTimeStyle)}),(null===a||a.sender_username!==o.sender_username)&&r.createElement("div",{style:b({},x.senderUsernameStyle,e.senderUsernameStyle),className:"ce-"+(h?"my":"their")+"-message-sender-username"},o.sender_username),r.createElement("div",{style:b({},x.attachmentsStyle,e.attachmentsStyle),className:"\n          ce-"+(h?"my":"their")+"-message-attachments \n          ce-"+(h?"my":"their")+"-message-images\n        "},F(!0)),r.createElement("div",{style:b({},x.attachmentsStyle,e.attachmentsStyle),className:"\n            ce-"+(h?"my":"their")+"-message-attachments \n            ce-"+(h?"my":"their")+"-message-files\n          "},F(!1)),null!==o.text&&r.createElement("div",{onMouseEnter:function(){return v(!0)},onMouseLeave:function(){return v(!1)},style:b({},x.bodyStyle,e.bodyStyle)},h&&r.createElement("span",{className:"ce-my-message-timestamp",style:b({},x.timeTagStyle,{opacity:y?"1":"0"},e.timeTagStyle)},Q(Z(o.created,e.timezoneOffset))),r.createElement("div",{className:"\n              ce-"+(h?"my":"their")+"-message-body\n              "+(d&&"ce-my-message-sending-body")+"\n            ",style:b({},x.bubbleStyle,C,E,e.bubbleStyle),dangerouslySetInnerHTML:{__html:L}}),r.createElement("style",null,"p {margin-block-start: 0px; margin-block-end: 0px;}"),!h&&r.createElement("span",{className:"ce-their-message-timestamp",style:b({},x.timeTagStyle,{opacity:y?"1":"0"},e.timeTagStyle)},Q(Z(o.created,e.timezoneOffset))),r.createElement(Y,{username:o.sender_username,style:b({},x.avatarStyle,k?{}:{display:"none"},e.avatarStyle),avatarUrl:o.sender&&null!==o.sender&&null!==o.sender.avatar?o.sender.avatar:void 0})),r.createElement("div",{style:b({},x.readsStyle,e.readsStyle),className:"ce-"+(h?"my":"their")+"-reads-row"},(null!==c?c.people:[]).map((function(t,n){return r.createElement(ve,{key:"read_"+n,avatarUrl:t.person.avatar,username:t.person.username,isVisible:o.id===t.last_read,style:b({},x.readStyle,e.readStyle)})}))))},Ne=function(e){var t,n,a=e.messages,i=o.mapKeys(void 0===a?[]:a,"created"),s=Object.keys(i).sort(),l=function(e){return e?e.substr(0,10):null};return e.renderMessageList?r.createElement(r.Fragment,null,e.renderMessageList(e)):r.createElement("div",{className:"ce-message-list",id:"ce-message-list-"+(null==(t=e.chat)?void 0:t.id),style:b({},he,e.style)},r.createElement("div",{className:"ce-message-list-content",id:"ce-message-list-content-"+(null==(n=e.chat)?void 0:n.id)},e.hasMoreMessages&&r.createElement(X,{onShow:e.onMessageLoaderShow,onHide:e.onMessageLoaderHide,children:r.createElement(te,{style:{position:"relative",left:"calc(50% - 0.625em)",width:"1.25em",height:"1.25em",font:"red"}})}),function(t){return t.map((function(n,a){var o=i[n],s=0===a?"":t[a-1],c=a===t.length-1?"":t[a+1],u=""!==s?l(s):void 0,d=""!==n?l(n):void 0,p=!u||u!==d,h=e.username===o.sender_username;return r.createElement("div",{key:"message_"+a,id:"ce-message-"+o.id},a===t.length-1&&r.createElement(X,{onShow:e.onBottomMessageShow,onHide:e.onBottomMessageHide,children:""}),r.createElement(Fe,{chat:e.chat,message:o,lastMessage:i[s],nextMessage:i[c],timezoneOffset:e.timezoneOffset,isMyMessage:h,isSending:!o.id,showDateTime:p,renderMessage:e.renderMessage,style:b({},fe,e.messageStyle)}))}))}(s)))},Ie={style:{paddingTop:"4px"},inputStyle:{border:"1px solid white",width:"calc(100% - 24px - 116px)",outline:"none",fontSize:"15px",fontFamily:"Avenir",paddingLeft:"12px",paddingRight:"12px",resize:"none",overflowX:"hidden",position:"relative",top:"6px"},sendButtonStyle:{cursor:"pointer",fontFamily:"Avenir",display:"inline-block",borderRadius:"8px",padding:"6px 12px",color:"white",transition:"all .33s ease",WebkitTransition:"all .33s ease",MozTransition:"all .33s ease",position:"relative",bottom:"6px"},draftAttachmentStyle:{padding:"6px",display:"inline-block",position:"relative"},draftAttachmentRemoveStyle:{position:"absolute",top:"-6px",right:"-6px",width:"30px",height:"30px",color:"#40a9ff",backgroundColor:"white",border:"1px solid rgb(67, 67, 67)",borderRadius:"50%",cursor:"pointer",transition:"all .33s ease",WebkitTransition:"all .33s ease",MozTransition:"all .33s ease"},draftImageStyle:{padding:"6px",height:"60px",width:"60px"},draftFileStyle:{}},Te={height:"0px",display:"inline",padding:"6px 12px",position:"relative",bottom:"6px"},Ae={backgroundColor:"white",border:"1px solid white",cursor:"pointer"},_e=function(e){var t=n.useState(!1),a=t[1],o={color:t[0]?"#06c":"#444"};return r.createElement("form",{className:"ce-attachment-input",encType:"multipart/form-data",style:b({},Te,e.style)},r.createElement("label",{htmlFor:"files",id:"ce-upload-document-button"},r.createElement("span",{className:"ce-attachment-icon",onMouseEnter:function(){return a(!0)},onMouseLeave:function(){return a(!1)},style:b({},Ae,o,e.iconStyle),onClick:function(){}},"📎")),r.createElement("input",{multiple:!0,id:"files",style:{visibility:"hidden",height:"0px",width:"0px"},type:"file",onChange:function(t){t.preventDefault(),e.onSelectFiles&&e.onSelectFiles(t.target.files)}}))},Oe=function(e){var t=e.label,a=void 0===t?"":t,o=n.useState(0),i=o[0],s=o[1],l=n.useState(""),c=l[0],u=l[1],d=n.useState(0),p=d[0],h=d[1],f=n.useState(!1),m=f[0],g=f[1],y=n.useState([]),v=y[0],x=y[1];n.useEffect((function(){return S()}),[]);var S=function(){var e=document.getElementById("msg-textarea");null!==e&&(e.style.height="",e.style.height=Math.min(e.scrollHeight,150)+"px",h(Math.min(e.scrollHeight,150)))},w=function(){var t=(new Date).toISOString().replace("T"," ").replace("Z",Math.floor(1e3*Math.random())+"+00:00"),n=v.map((function(e){return{id:-1,created:(new Date).toString(),file:e.name,blob:e}}));e.onSubmit&&e.onSubmit({attachments:n,text:c,sender_username:e.username?e.username:"",custom_json:{},created:t}),u(""),x([]),S()},C=function(t){return v&&null!==v?Array.from(v).map((function(n,a){var o=URL.createObjectURL(n);return r.createElement("span",{key:"draft-"+a,className:"ce-draft-attachment-wrapper",style:b({},Ie.draftAttachmentStyle,e.draftAttachmentStyle)},t&&Ce(n.name)&&r.createElement(Le,{url:o,style:b({},Ie.draftImageStyle,e.draftImageStyle),className:"ce-draft-image"}),!t&&!Ce(n.name)&&r.createElement(ke,{url:o,fileName:"📄 "+n.name,style:b({},Ie.draftFileStyle,e.draftFileStyle),className:"ce-draft-file"}),(!t&&!Ce(n.name)||t&&Ce(n.name))&&r.createElement("button",{className:"ce-message-attachment-remove-btn",onClick:function(){return function(e){if(v&&null!==v){var t=v;t.splice(e,1),x(t),s(i+1)}}(a)},style:b({},Ie.draftAttachmentRemoveStyle,e.draftAttachmentRemoveStyle)},"❌"))})):r.createElement("div",null)};return e.renderMessageForm?r.createElement(r.Fragment,null,e.renderMessageForm(e)):r.createElement("div",{id:"ce-message-form",style:b({},Ie.style,e.style),className:"ce-message-form"},r.createElement("div",{className:"ce-message-form-attachments-row"},C(!0)),r.createElement("div",{className:"ce-message-form-attachments-row"},C(!1)),r.createElement("textarea",{id:"msg-textarea",className:"ce-message-form-input",value:c,placeholder:a,rows:1,onKeyDown:function(e){"Enter"===e.key&&(e.preventDefault(),c.length>0&&w())},onChange:function(t){u(t.target.value),e.onChange&&e.onChange(t),S()},style:b({},Ie.inputStyle,{overflowY:150===p?"scroll":"hidden"},e.inputStyle)}),r.createElement(_e,{onSelectFiles:function(e){null!==e&&x(Array.from(e))},style:b({},Ie.attachmentInputStyle,e.attachmentInputStyle),iconStyle:b({},Ie.attachmentInputIconStyle,e.attachmentInputIconStyle)}),r.createElement("div",{id:"ce-send-message-button",onMouseEnter:function(){return g(!0)},onMouseLeave:function(){return g(!1)},onClick:w,style:b({},Ie.sendButtonStyle,{backgroundColor:m?"#40a9ff":"#1890ff"},e.sendButtonStyle)},"Send"))},De={width:"100%",textAlign:"center"},ze={width:"50%",maxWidth:"200px"},Re={color:"#afafaf",fontWeight:600,fontSize:"14px",fontFamily:"Avenir"},Pe=function(e){return e.renderWelcomeGif?r.createElement(r.Fragment,null,e.renderWelcomeGif(e)):r.createElement("div",{className:"ce-ice-breaker-wrapper",style:b({},De,e.style)},r.createElement("img",{className:"ce-ice-breaker-gif",style:b({},ze,e.gifStyle),src:"https://chat-engine-assets.s3.amazonaws.com/welcome_gifs/peace.gif",alt:"chat-engine-ice-breaker"}),r.createElement("div",{className:"ce-ice-breaker-text",style:b({},Re,e.textStyle)},"No messages here yet..."))},Be=function(e,t){return void 0===t&&(t=0),e?e.last_message.created&&e.last_message.created.length>0?"Active "+$(Z(e.last_message.created,t)):"Say hello!":"⬅️ ⬅️ ⬅️"},He=function(e){var t=e.chat,n=t&&t.people.find((function(t){return t.person.username!==e.username})),a=e.isLoading?r.createElement(te,null):t?t.is_direct_chat&&n?n.person.username:t.title:"Create a chat!";return e.renderChatFeed?r.createElement(r.Fragment,null,e.renderChatFeed(e)):r.createElement("div",{className:"ce-chat-feed",style:b({},ae,e.style)},r.createElement(pe,{title:a,description:e.isLoading?"Loading...":Be(t,e.timezoneOffset),renderChatHeader:e.renderChatHeader,style:b({},oe,e.chatHeaderStyle)}),r.createElement(Ne,{chat:t,messages:e.messages,username:e.username,timezoneOffset:e.timezoneOffset,hasMoreMessages:e.hasMoreMessages,onMessageLoaderShow:e.onMessageLoaderShow,onMessageLoaderHide:e.onMessageLoaderHide,onBottomMessageShow:e.onBottomMessageShow,onBottomMessageHide:e.onBottomMessageHide,renderMessageList:e.renderMessageList,renderMessage:e.renderMessage,style:b({},ie,e.messageListStyle)}),0===e.messages.length&&!e.isLoading&&r.createElement(Pe,{style:{position:"absolute",top:"calc(50% - 112px)"}}),r.createElement(Oe,{label:"Send a message...",username:e.username,onSubmit:e.onMessageFormSubmit,renderMessageForm:e.renderMessageForm,style:b({},se,e.messageFormStyle)}))},Ue={style:{backgroundColor:"white",width:"100%",height:"100%"},chatTitleStyle:{width:"100%",textAlign:"center",fontFamily:"Avenir",fontSize:"18px",fontWeight:600}},We={style:{width:"100%",paddingTop:"12px",height:"calc(44px + 14px)"},oneAvatarStyle:{avatarOne:{float:"left",position:"relative",left:"calc(50% - 22px)"}},twoAvatarsStyle:{avatarOne:{float:"left",position:"relative",left:"calc(50% - 22px - 15px)"},avatarTwo:{float:"left",position:"relative",left:"calc(50% - 44px - 22px + 15px)"}},threeAvatarsStyle:{avatarOne:{float:"left",position:"relative",left:"calc(50% - 22px - 24px)"},avatarTwo:{float:"left",position:"relative",left:"calc(50% - 24px - 44px)"},avatarThree:{float:"left",position:"relative",left:"calc(50% - 22px - 44px - 44px + 24px)"}}},je=function(e){var t=e.users,n=void 0===t?[]:t,a=function(e,t){return 1===e.length?t.oneAvatarStyle?t.oneAvatarStyle:{}:2===e.length?t.twoAvatarsStyle?t.twoAvatarsStyle:{}:t.threeAvatarsStyle?t.threeAvatarsStyle:{}},o=function(t){if(e.isDirectChat){var r=n.find((function(t){return t.username!==e.username}));return r?[r]:[]}return t.slice(0,3)}(n),i=a(n,We),s=a(n,e);return e.renderChatAvatars?r.createElement(r.Fragment,null,e.renderChatAvatars(e)):r.createElement("div",{className:"ce-chat-avatars",style:b({},We.style,e.style)},r.createElement(Y,{className:"ce-chat-avatar-1",username:o[0]?o[0].username:void 0,avatarUrl:o[0]?o[0].avatar:void 0,style:b({},i.avatarOne,{display:o[0]?"inherit":"none"},s.avatarOne)}),r.createElement(Y,{className:"ce-chat-avatar-2",username:o[1]?o[1].username:void 0,avatarUrl:o[1]?o[1].avatar:void 0,style:b({},i.avatarTwo,{display:o[1]?"inherit":"none"},s.avatarTwo)}),r.createElement(Y,{className:"ce-chat-avatar-3",username:o[2]?o[2].username:void 0,avatarUrl:o[2]?o[2].avatar:void 0,style:b({},i.avatarThree,{display:o[2]?"inherit":"none"},s.avatarThree)}))},Ge={},Ke={position:"absolute",left:"12px",top:"2px"},Ye={fontFamily:"Avenir",position:"absolute",left:"72px",top:"12px",width:"calc(100% - 84px - 52px - 12px)"},qe={position:"absolute",right:"12px",top:"8px"},Ve={fontFamily:"Avenir",padding:"8px 12px",cursor:"pointer"},Je={width:"calc(100% - 12px - 12px)",position:"relative",left:"12px"},Xe={border:"1px solid rgb(24, 144, 255)"},Ze={position:"relative"},Qe={width:"100%",height:"36px",padding:"0px 12px",boxSizing:"border-box",fontSize:"15px",fontFamily:"Avenir",outline:"none",borderRadius:"24px"},$e={cursor:"pointer",position:"absolute",top:"5px",right:"12px"},et={overflow:"hidden"},tt={target:{value:""}},nt=function(e){var t=n.useRef(null),a=n.useRef(!1),o=n.useState(""),i=o[0],s=o[1],l=n.useState(!1),c=l[0],u=l[1];n.useEffect((function(){return a.current||(a.current=!0,document.addEventListener("mousedown",d)),function(){return document.removeEventListener("mousedown",d)}}),[]);var d=function(e){null!==e.target&&t&&null!==t.current&&!t.current.contains(e.target)&&u(!1)},p=function(t,n){s(t.target.value),u(n),e.onChange&&e.onChange(t)};return r.createElement("div",{ref:t,className:"ce-autocomplete",style:b({},Ze,e.style)},r.createElement("input",{className:"ce-autocomplete-input",value:i,placeholder:e.label,style:b({},Qe,e.inputStyle),onChange:function(e){return p(e,!0)},onFocus:function(t){u(!0),e.onFocus&&e.onFocus(t)}}),r.createElement("div",{className:"ce-autocomplete-close",onClick:function(){return p(tt,!0)},style:b({},$e,{display:i.length>0?"inline-block":"none"},e.closeStyle)},"❌"),r.createElement("div",{style:b({},et,{height:c?"auto":"0px"},e.optionsStyle)},function(t){return function(e,t,n){return t.filter((function(t){return-1!==JSON.stringify(t).toLowerCase().indexOf(e.toLowerCase())})).slice(0,n)}(t,e.options,e.maxVisibleOptions?e.maxVisibleOptions:3).map((function(t,n){return r.createElement("div",{key:"option-"+n},e.renderOption?e.renderOption(t):t.toString())}))}(i)))},rt={style:{borderTop:"1px solid #f0f0f0"},barStyle:{position:"relative",cursor:"pointer",backgroundColor:"white",transition:"all .33s ease",WebkitTransition:"all .33s ease",MozTransition:"all .33s ease",fontFamily:"Avenir",fontSize:"17px",padding:"12px",fontWeight:600},barHoveredStyle:{backgroundColor:"#f0f0f0"},iconStyle:{position:"absolute",right:"12px",bottom:"15px",width:"1em",height:"1em",transition:"transform 100ms"},bodyStyle:{height:"0px",overflow:"hidden",transition:"all 1.33s ease",WebkitTransition:"all 1.33s ease",MozTransition:"all 1.33s ease"},bodyExpandedStyle:{height:"auto"}},at=function(e){var t=n.useState(!1),a=t[0],o=t[1],i=n.useState(!1),s=i[0],l=i[1];return r.createElement("div",{id:e.id,className:"ce-dropdown "+e.className,style:b({},rt.style,e.style)},r.createElement("div",{className:"ce-dropdown-label",onMouseEnter:function(){return o(!0)},onMouseLeave:function(){return o(!1)},onClick:function(){return l(!s)},style:b({},rt.barStyle,a&&rt.barHoveredStyle,e.barStyle,a&&e.barHoveredStyle)},e.label,r.createElement("svg",{className:"ce-dropdown-icon",style:b({},rt.iconStyle,s?{transform:"rotate(-90deg)"}:{transform:"rotate(0deg)"},e.iconStyle),viewBox:"64 64 896 896",focusable:"false","data-icon":"left",fill:"currentColor","aria-hidden":"true"},r.createElement("path",{d:"M724 218.3V141c0-6.7-7.7-10.4-12.9-6.3L260.3 486.8a31.86 31.86 0 000 50.3l450.8 352.1c5.3 4.1 12.9.4 12.9-6.3v-77.3c0-4.9-2.3-9.6-6.1-12.6l-360-281 360-281.1c3.8-3 6.1-7.7 6.1-12.6z"}))),r.createElement("div",{className:"ce-dropdown-children",style:b({},rt.bodyStyle,s&&rt.bodyExpandedStyle,e.bodyStyle,s&&e.bodyExpandedStyle)},e.children))},ot=function(e){var t=e.chat,n=void 0===t?{people:[]}:t,a=e.peopleToInvite,o=void 0===a?[]:a;return e.renderPeopleSettings?r.createElement(r.Fragment,null,e.renderPeopleSettings(e)):r.createElement(at,{id:"ce-settings-people-dropdown",label:"Members",style:b({},Ge,e.style)},n.people.map((function(t,n){var a=t.person;return r.createElement("div",{key:"member-"+n,style:{height:"52px",position:"relative"}},r.createElement(Y,{username:a.username,avatarUrl:a.avatar,isOnline:a.is_online,style:b({},Ke,e.avatarStyle)}),r.createElement("div",{style:b({},Ye,e.usernameStyle)},a.username),e.canDelete&&r.createElement(z,{type:"danger",className:"ce-member-delete-button",onClick:function(){return e.onRemovePersonClick&&e.onRemovePersonClick(a)},style:b({},qe,e.deleteButtonStyle)},r.createElement("svg",{viewBox:"64 64 896 896",focusable:"false","data-icon":"close",width:"1em",height:"1em",fill:"currentColor","aria-hidden":"true"},r.createElement("path",{d:"M563.8 512l262.5-312.9c4.4-5.2.7-13.1-6.1-13.1h-79.8c-4.7 0-9.2 2.1-12.3 5.7L511.6 449.8 295.1 191.7c-3-3.6-7.5-5.7-12.3-5.7H203c-6.8 0-10.5 7.9-6.1 13.1L459.4 512 196.9 824.9A7.95 7.95 0 00203 838h79.8c4.7 0 9.2-2.1 12.3-5.7l216.5-258.1 216.5 258.1c3 3.6 7.5 5.7 12.3 5.7h79.8c6.8 0 10.5-7.9 6.1-13.1L563.8 512z"}))))})),r.createElement(nt,{label:"Add Member",options:o,renderOption:function(t){var n=t,a=e.onInvitePersonClick;return r.createElement("div",{className:"ce-add-member-option",style:b({},Ve,e.optionStyle),onClick:function(){return a&&a(n)}},n.username)},style:b({},Je,e.addMemberStyle),inputStyle:b({},Xe,e.addMemberInputStyle)}))},it={},st={position:"relative",width:"33.3%",display:"inline-block",cursor:"pointer"},lt={paddingTop:"100%"},ct={top:"0px",width:"100%",height:"100%",position:"absolute",objectFit:"cover",padding:"0px",borderRadius:"0px"},ut=function(e){var t=e.chat,n=void 0===t?{attachments:[]}:t;return e.renderPhotosSettings?r.createElement(r.Fragment,null,e.renderPhotosSettings(e)):r.createElement(at,{id:"ce-settings-photos-dropdown",label:"Photos",style:b({},it,e.style)},n.attachments.map((function(t,n){var a=Ee(t.file);return Ce(a)?r.createElement("div",{key:"photo-"+n,style:b({},st,e.imageWrapperStyle)},r.createElement("div",{style:b({},lt,e.imagePaddingStyle)}),r.createElement(Le,{key:"attachment_"+n,className:"ce-settings-image",url:null!==t.file?t.file:void 0,style:b({},ct,e.imageStyle)})):r.createElement("span",{key:"photo-"+n})})))},dt={},pt={width:"calc(100% - 24px)",position:"relative",left:"12px"},ht=function(e){return e.renderOptionsSettings?r.createElement(r.Fragment,null,e.renderOptionsSettings(e)):r.createElement(at,{id:"ce-settings-options-dropdown",label:"Options",style:b({},dt,e.style)},r.createElement(z,{type:"danger",onClick:function(){return e.onDeleteChatClick&&e.chat&&e.onDeleteChatClick(e.chat)},style:b({},pt,e.deleteChatButtonStyle)},"Delete this Chat"))},ft=function(e){var t=e.chat;if(e.renderChatSettings)return r.createElement(r.Fragment,null,e.renderChatSettings(e));var n=t?t.people.map((function(e){return e.person})):[],a=t&&t.people.find((function(t){return t.person.username!==e.username})),o=e.isLoading||!t?"":t.is_direct_chat&&a?a.person.username:t.title;return r.createElement("div",{className:"ce-chat-settings",style:b({},Ue.style,e.style)},r.createElement(je,{users:n,username:e.username,renderChatAvatars:e.renderChatAvatars}),r.createElement("div",{className:"ce-chat-settings-title",style:b({},Ue.chatTitleStyle,e.chatTitleStyle)},o),r.createElement(ot,{chat:t,peopleToInvite:e.peopleToInvite,canDelete:t&&e.username===t.admin.username,onInvitePersonClick:e.onInvitePersonClick,onRemovePersonClick:e.onRemovePersonClick,renderPeopleSettings:e.renderPeopleSettings,style:b({},Ue.peopleSettingsStyle,e.peopleSettingsStyle)}),r.createElement(ut,{chat:t,renderPhotosSettings:e.renderPhotosSettings,style:b({},Ue.photosSettingsStyle,e.photosSettingsStyle)}),r.createElement(ht,{chat:t,onDeleteChatClick:e.onDeleteChatClick,renderOptionsSettings:e.renderOptionsSettings,style:b({},Ue.optionsSettingsStyle,e.optionsSettingsStyle)}))};a.setConfiguration({maxScreenClass:"xl",gutterWidth:0});var mt,gt,yt=function(e,t){document.getElementById(t)&&s.animateScroll.scrollToBottom({duration:e,containerId:t})},vt=function(e){return e.sort((function(e,t){var n=Z(e.last_message&&e.last_message.created?e.last_message.created:e.created),r=Z(t.last_message&&t.last_message.created?t.last_message.created:t.created);return new Date(r).getTime()-new Date(n).getTime()}))},xt=function(e){return e.sort((function(e,t){return new Date(t.created).getTime()-new Date(e.created).getTime()}))},St=function(e){return e.sort((function(e,t){return new Date(t.created).getTime()-new Date(e.created).getTime()}))},wt=function(e){var t=e.sessionToken;return t?r.createElement(l.WebSocket,{url:(e.wsUrl?e.wsUrl:"wss://api.chatengine.io")+"/person_v4/?session_token="+t,reconnect:!0,reconnectIntervalInMilliSeconds:3e3,onOpen:e.onConnect,onError:e.onError,onMessage:function(t){var n=JSON.parse(t);if("new_chat"===n.action)e.onNewChat&&e.onNewChat(n.data);else if("edit_chat"===n.action||"add_person"===n.action||"remove_person"===n.action)e.onEditChat&&e.onEditChat(n.data);else if("delete_chat"===n.action)e.onDeleteChat&&e.onDeleteChat(n.data);else if("new_message"===n.action){var r=n.data;e.onNewMessage&&e.onNewMessage(r.id,r.message)}else if("edit_message"===n.action){var a=n.data;e.onEditMessage&&e.onEditMessage(a.id,a.message)}else if("delete_message"===n.action){var o=n.data;e.onDeleteMessage&&e.onDeleteMessage(o.id,o.message)}else if("is_typing"===n.action){var i=n.data;e.onIsTyping&&e.onIsTyping(i.id,i.person)}},onClose:function(){e.onClose&&e.onClose(),e.onRefresh&&e.onRefresh()}}):r.createElement("div",null)},bt=void 0,Ct=function(e){var t=n.useState(Date.now()),a=t[0],o=t[1],i=n.useState(Date.now()+15e3),s=i[0],c=i[1],u=e.projectId,d=e.chatId,p=e.chatAccessKey;return n.useEffect((function(){a>s&&(e.onRefresh&&e.onRefresh(),c(Date.now()+15e3))}),[a,s]),n.useEffect((function(){return function(){clearInterval(mt),clearInterval(gt)}}),[]),r.createElement(l.WebSocket,{url:(e.wsUrl?e.wsUrl:"wss://api.chatengine.io")+"/chat/?projectID="+u+"&chatID="+d+"&accessKey="+p,reconnect:!0,reconnectIntervalInMilliSeconds:3e3,childRef:function(e){return bt=e},onOpen:function(){mt=setInterval((function(){try{bt.sendMessage(JSON.stringify("ping"))}catch(e){console.log("Ping error",e)}}),4e3),gt=setInterval((function(){return o(Date.now())}),1e3),e.onConnect&&e.onConnect()},onError:e.onError,onMessage:function(t){var n=JSON.parse(t);if("pong"===n.action)c(Date.now()+15e3);else if("login_error"===n.action)console.log("Your chat auth credentials were not correct: \n\n                Project ID: "+u+" \n\n                Chat ID: "+d+" \n\n                Chat Access Key: "+p+"\n\n                Double check these credentials to make sure they're correct.\n\n                If all three are correct, try resetting the username and secret in the Online Dashboard or Private API."),e.onAuthFail&&e.onAuthFail();else if("edit_chat"===n.action||"add_person"===n.action||"remove_person"===n.action)e.onEditChat&&e.onEditChat(n.data);else if("delete_chat"===n.action)e.onDeleteChat&&e.onDeleteChat(n.data);else if("new_message"===n.action){var r=n.data;e.onNewMessage&&e.onNewMessage(r.id,r.message)}else if("edit_message"===n.action){var a=n.data;e.onEditMessage&&e.onEditMessage(a.id,a.message)}else if("delete_message"===n.action){var o=n.data;e.onDeleteMessage&&e.onDeleteMessage(o.id,o.message)}else if("is_typing"===n.action){var i=n.data;e.onIsTyping&&e.onIsTyping(i.id,i.person)}},onClose:function(){e.onClose&&e.onClose(),e.onRefresh&&e.onRefresh()}})};exports.Autocomplete=nt,exports.Avatar=Y,exports.Button=z,exports.ChatAvatars=je,exports.ChatCard=V,exports.ChatFeed=He,exports.ChatForm=U,exports.ChatHeader=pe,exports.ChatList=re,exports.ChatSettings=ft,exports.Dot=ve,exports.Dropdown=at,exports.File=ke,exports.Image=Le,exports.Input=H,exports.MessageForm=Oe,exports.MessageList=Ne,exports.MultiChatSocket=function(e){var a=n.useRef(!1),o=n.useState(!1),i=o[0],s=o[1],l=n.useState(void 0),c=l[0],u=l[1];function d(){return(d=w(x().mark((function e(){return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:s(!0),setTimeout((function(){return s(!1)}),100);case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return n.useEffect((function(){a.current||(a.current=!0,t.get((e.httpUrl?e.httpUrl:"https://api.chatengine.io")+"/users/me/session/",{headers:{"Public-Key":e.projectId,"User-Name":e.username,"User-Secret":e.secret}}).then((function(e){return u(e.data.token)})).catch((function(){return console.log("Your login credentials were not correct: \n\n              Project ID: "+e.projectId+" \n\n              Username: "+e.username+" \n\n              Secret: "+e.secret+"\n\n              Double check these credentials to make sure they're correct.\n\n              If all three are correct, try resetting the username and secret in the Online Dashboard or Private API."),void(e.onAuthFail&&e.onAuthFail())})))}),[]),i&&c?r.createElement("div",null):r.createElement(wt,{projectId:e.projectId,username:e.username,secret:e.secret,sessionToken:c,wsUrl:e.wsUrl,onRefresh:function(){return d.apply(this,arguments)},onConnect:e.onConnect,onError:e.onError,onClose:e.onClose,onNewChat:e.onNewChat,onEditChat:e.onEditChat,onDeleteChat:e.onDeleteChat,onNewMessage:e.onNewMessage,onEditMessage:e.onEditMessage,onDeleteMessage:e.onDeleteMessage,onIsTyping:e.onIsTyping})},exports.MultiChatWindow=function(e){if("undefined"==typeof window)return r.createElement("div",null);var t=e.chats,o=void 0===t?[]:t,s=e.activeChatId,l=void 0===s?-1:s,c=e.messages,u=void 0===c?[]:c,d=n.useState(window.innerWidth<575),p=d[0],h=d[1],f=o.find((function(e){return e.id===l}));n.useEffect((function(){window.addEventListener("resize",(function(){h(window.innerWidth<575)}))}));var m=function(){return r.createElement(re,{chats:o,activeChatId:l,username:e.username,timezoneOffset:e.timezoneOffset,isLoading:e.isChatListLoading,hasMoreChats:e.hasMoreChats,onChatFormSubmit:e.onChatFormSubmit,onChatCardClick:e.onChatCardClick,onChatLoaderShow:e.onChatLoaderShow,renderChatList:e.renderChatList,renderChatForm:e.renderChatForm,renderChatCard:e.renderChatCard,style:{position:p?"absolute":"inherit",zIndex:p?1:"inherit"}})},g=function(){return r.createElement(ft,{chat:f,username:e.username,peopleToInvite:e.peopleToInvite,isLoading:e.isChatSettingsLoading,onInvitePersonClick:e.onInvitePersonClick,onRemovePersonClick:e.onRemovePersonClick,onDeleteChatClick:e.onDeleteChatClick,renderChatSettings:e.renderChatSettings,renderChatAvatars:function(t){return r.createElement(r.Fragment,null,r.createElement(je,Object.assign({},t,{renderChatAvatars:e.renderChatAvatars})),p&&r.createElement(z,{onClick:e.onCloseMobileChatSettingsClick,style:{position:"absolute",top:"12px",right:"12px"}},r.createElement(i.CloseOutlined,null)))},renderPeopleSettings:e.renderPeopleSettings,renderPhotosSettings:e.renderPhotosSettings,renderOptionsSettings:e.renderOptionsSettings,style:{position:p?"absolute":"inherit",zIndex:p?1:"inherit"}})};return r.createElement(a.Row,{className:"ce-chat-engine",style:b({},C,e.style)},r.createElement(a.Col,{xs:0,sm:3,className:"ce-chat-list-column",style:b({},E,e.chatListColumnStyle)},m()),r.createElement(a.Col,{xs:12,sm:6,className:"ce-chat-feed-column",style:b({},k,e.chatFeedColumnStyle)},r.createElement(He,{chat:f,messages:u,username:e.username,timezoneOffset:e.timezoneOffset,isLoading:e.isChatFeedLoading,hasMoreMessages:e.hasMoreMessages,onMessageLoaderShow:e.onMessageLoaderShow,onMessageLoaderHide:e.onMessageLoaderHide,onBottomMessageShow:e.onBottomMessageShow,onBottomMessageHide:e.onBottomMessageHide,onMessageFormSubmit:e.onMessageFormSubmit,renderChatFeed:e.renderChatFeed,renderChatHeader:e.renderChatHeader,renderMessageList:e.renderMessageList,renderMessage:e.renderMessage,renderWelcomeGif:e.renderWelcomeGif,renderMessageForm:e.renderMessageForm})),r.createElement(a.Col,{xs:0,sm:3,className:"ce-chat-settings-column",style:b({},M,e.chatSettingsColumnStyle)},g()),r.createElement(z,{onClick:e.onMobileChatListClick,className:"ce-mobile-chat-list-button",style:b({},L,{display:p?"inherit":"none"},e.chatListMobileButtonStyle)},r.createElement(i.UnorderedListOutlined,null)),p&&e.isMobileChatListOpen&&m(),r.createElement(z,{onClick:e.onMobileChatSettingsClick,className:"ce-mobile-chat-settings-button",style:b({},F,{display:p?"inherit":"none"},e.chatSettingsMobileButtonStyle)},r.createElement(i.SettingOutlined,null)),p&&e.isMobileChatSettingsOpen&&g())},exports.OptionsSettings=ht,exports.PeopleSettings=ot,exports.PhotosSettings=ut,exports.RenderTrigger=X,exports.SingleChatSocket=function(e){var t=n.useRef(!1),a=n.useState(!1),o=a[0],i=a[1];function s(){return(s=w(x().mark((function e(){return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:i(!0),setTimeout((function(){return i(!1)}),100);case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return n.useEffect((function(){t.current||(t.current=!0)}),[]),o?r.createElement("div",null):r.createElement(Ct,{projectId:e.projectId,chatId:e.chatId,chatAccessKey:e.chatAccessKey,wsUrl:e.wsUrl,onRefresh:function(){return s.apply(this,arguments)},onConnect:e.onConnect,onAuthFail:e.onAuthFail,onError:e.onError,onClose:e.onClose,onEditChat:e.onEditChat,onDeleteChat:e.onDeleteChat,onNewMessage:e.onNewMessage,onEditMessage:e.onEditMessage,onDeleteMessage:e.onDeleteMessage,onIsTyping:e.onIsTyping})},exports.Spinner=te,exports.deleteChat=h,exports.formatDateTime=$,exports.formatTime=Q,exports.getChat=p,exports.getChatsBefore=f,exports.getDateTime=Z,exports.getMessages=c,exports.getOrCreateChat=function(e,n,r,a){void 0===e&&(e="https://api.chatengine.io"),t.put(e+"/chats/",r,{headers:n}).then((function(e){a&&a(e.data)})).catch((function(e){console.log("Get or Create Chat Error",e)}))},exports.getPeopleToInvite=g,exports.invitePerson=y,exports.newChat=m,exports.newMessage=u,exports.readMessage=d,exports.removePerson=v,exports.useMultiChatLogic=function(e,t,r,a){var o=a||"https://api.chatengine.io",i={"Public-Key":e,"User-Name":t,"User-Secret":r},l=n.useState(),p=l[0],S=l[1],b=n.useState([]),C=b[0],E=b[1],k=n.useState([]),M=k[0],L=k[1],F=n.useState([]),N=F[0],I=F[1],T=n.useState(!1),A=T[0],_=T[1],O=n.useState(!1),D=O[0],z=O[1],R=n.useState(!1),P=R[0],B=R[1],H=n.useState(!0),U=H[0],W=H[1],j=n.useState(!0),G=j[0],K=j[1],Y=n.useState(!0),q=Y[0],V=Y[1],J=n.useState(!1),X=J[0],Z=J[1],Q=n.useState(!1),$=Q[0],ee=Q[1],te=n.useRef(0);te.current=C.length;var ne=n.useRef(0);ne.current=M.length;var re=C.find((function(e){return e.id===p})),ae=n.useRef(!1);function oe(){return ie.apply(this,arguments)}function ie(){return(ie=w(x().mark((function e(){var t;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=(new Date).toISOString().replace("T"," ").replace("Z",Math.floor(1e3*Math.random())+"+00:00"),f(o,i,t,te.current>0?te.current:20,(function(e){se(e);var t=p;!p&&e.length>0&&(t=e[0].id),t?be(t):K(!1)})),e.abrupt("return");case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function se(e){return le.apply(this,arguments)}function le(){return(le=w(x().mark((function e(t){var n;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return void 0===t&&(t=[]),_(t.length>=te.current+20),n=vt(t),E(n),W(!1),e.abrupt("return");case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function ce(e){return ue.apply(this,arguments)}function ue(){return(ue=w(x().mark((function e(t){var n;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=[t].concat(C||[]),E(n),e.abrupt("return");case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function de(){return(de=w(x().mark((function e(t){var n,r,a;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=C?C.filter((function(e){return e.id!==t.id})):[],r=[t].concat(n),a=vt(r),E(a),e.abrupt("return");case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function pe(e){return he.apply(this,arguments)}function he(){return(he=w(x().mark((function e(t){var n;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=C?C.filter((function(e){return e.id!==t.id})):[],E(n),n.length>0&&p===t.id&&be(n[0].id),e.abrupt("return");case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function fe(e,t){return me.apply(this,arguments)}function me(){return(me=w(x().mark((function e(t,n){return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return z(n.length>=ne.current+50),L(n),e.abrupt("return");case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function ge(){return(ge=w(x().mark((function e(t,n){var r,a,o;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return p===t&&(r=M?M.filter((function(e){return e.created!==n.created})):[],a=r.concat(n),o=xt(a),L(o),P&&yt(333,"ce-message-list-"+p)),e.abrupt("return");case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function ye(){return(ye=w(x().mark((function e(t,n){var r,a,o;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t===p&&(r=M?M.filter((function(e){return e.id!==n.id})):[],a=[n].concat(r),o=xt(a),L(o)),e.abrupt("return");case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function ve(){return(ve=w(x().mark((function e(t,n){var r;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t===p&&(r=M?M.filter((function(e){return e.id!==n.id})):[],L(r)),e.abrupt("return");case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function xe(){return(xe=w(x().mark((function e(){return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return oe(),e.abrupt("return");case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Se(){return(Se=w(x().mark((function e(){return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function we(){return(we=w(x().mark((function e(t){return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return m(o,i,t,(function(e){ce(e),be(e.id)})),e.abrupt("return");case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function be(e){return Ce.apply(this,arguments)}function Ce(){return(Ce=w(x().mark((function e(t){return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t!==p&&(K(!0),V(!0)),S(t),Z(!1),c(o,i,t,50,(function(e,t){fe(e,t),K(!1),V(!1),yt(0,"ce-message-list-"+p)})),g(o,i,t,I),e.abrupt("return");case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Ee(){return(Ee=w(x().mark((function e(){var t;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=(new Date).toISOString().replace("T"," ").replace("Z","0000+00:00"),f(o,i,t,te.current+20,se),e.abrupt("return");case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function ke(){return(ke=w(x().mark((function e(t){var n;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=null==M?void 0:M.concat(t),L(n),u(o,i,p,t,(function(){})),setTimeout((function(){yt(333,"ce-message-list-"+p)}),100),e.abrupt("return");case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Me(){return(Me=w(x().mark((function e(t){return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:p&&y(o,i,p,t.username,(function(){return be(p)}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Le(){return(Le=w(x().mark((function e(t){return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return p&&v(o,i,p,t.username,(function(){return be(p)})),e.abrupt("return");case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Fe(){return(Fe=w(x().mark((function e(t){return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return h(o,i,t.id,pe),e.abrupt("return");case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Ne(){return(Ne=w(x().mark((function e(){return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return B(!0),e.abrupt("return");case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Ie(){return(Ie=w(x().mark((function e(){return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return B(!1),e.abrupt("return");case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Te(){return(Te=w(x().mark((function e(){var t,n,r,a;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t="ce-message-list-"+p,n="ce-message-list-content-"+p,r=document.getElementById(n),a=r?r.clientHeight:0,p&&c(o,i,p,ne.current+50,(function(e,r){fe(e,r),setTimeout((function(){var e=document.getElementById(n);e&&s.animateScroll.scrollTo(e.clientHeight-a,{duration:333,containerId:t})}),1e3)})),e.abrupt("return");case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Ae(){return(Ae=w(x().mark((function e(){return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return");case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function _e(){return(_e=w(x().mark((function e(t,n){return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return");case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Oe(){return(Oe=w(x().mark((function e(){return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return Z(!0),e.abrupt("return");case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function De(){return(De=w(x().mark((function e(){return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return ee(!0),e.abrupt("return");case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function ze(){return(ze=w(x().mark((function e(){return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return ee(!1),e.abrupt("return");case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return n.useEffect((function(){ae.current||(ae.current=!0,oe())}),[]),n.useEffect((function(){var e=C.find((function(e){return e.id===p})),n=null==e?void 0:e.people.find((function(e){return e.person.username===t}));p&&null!=e&&e.last_message.id&&e.last_message.id!==(null==n?void 0:n.last_read)&&P&&d(o,i,p,e.last_message.id,(function(){}))}),[C,p,P]),{onConnect:function(){return xe.apply(this,arguments)},onAuthFail:function(){return Se.apply(this,arguments)},onGetChats:se,onNewChat:ce,onEditChat:function(e){return de.apply(this,arguments)},onDeleteChat:pe,onGetMessages:fe,onNewMessage:function(e,t){return ge.apply(this,arguments)},onEditMessage:function(e,t){return ye.apply(this,arguments)},onDeleteMessage:function(e,t){return ve.apply(this,arguments)},onIsTyping:function(e,t){return _e.apply(this,arguments)},projectId:e,username:t,secret:r,httpUrl:a,wsUrl:a&&a.replace("http","ws"),chats:C,setChats:E,messages:M,setMessages:L,peopleToInvite:N,setPeopleToInvite:I,activeChatId:p,setActiveChatId:S,chat:re,hasMoreChats:A,setHasMoreChats:_,hasMoreMessages:D,setHasMoreMessages:z,isChatFeedAtBottom:P,setIsChatFeedAtBottom:B,isChatListLoading:U,setIsChatListLoading:W,isChatFeedLoading:G,setIsChatFeedLoading:K,isChatSettingsLoading:q,setIsChatSettingsLoading:V,isMobileChatListOpen:X,setIsMobileChatListOpen:Z,isMobileChatSettingsOpen:$,setIsMobileChatSettingsOpen:ee,onChatFormSubmit:function(e){return we.apply(this,arguments)},onChatCardClick:be,onChatLoaderShow:function(){return Ee.apply(this,arguments)},onMessageLoaderShow:function(){return Te.apply(this,arguments)},onMessageLoaderHide:function(){return Ae.apply(this,arguments)},onBottomMessageShow:function(){return Ne.apply(this,arguments)},onBottomMessageHide:function(){return Ie.apply(this,arguments)},onMessageFormSubmit:function(e){return ke.apply(this,arguments)},onInvitePersonClick:function(e){return Me.apply(this,arguments)},onRemovePersonClick:function(e){return Le.apply(this,arguments)},onDeleteChatClick:function(e){return Fe.apply(this,arguments)},onMobileChatListClick:function(){return Oe.apply(this,arguments)},onMobileChatSettingsClick:function(){return De.apply(this,arguments)},onCloseMobileChatSettingsClick:function(){return ze.apply(this,arguments)}}},exports.useSingleChatLogic=function(e,t,r,a){var o=a||"https://api.chatengine.io",i={"Public-Key":e,"Chat-ID":t,"Access-Key":r},l=n.useState(),d=l[0],h=l[1],f=n.useState(),m=f[0],g=f[1],y=n.useState([]),v=y[0],S=y[1],b=n.useState([]),C=b[0],E=b[1],k=n.useState(!1),M=k[0],L=k[1],F=n.useState(!1),N=F[0],I=F[1],T=n.useState(!1),A=T[0],_=T[1],O=n.useState(!0),D=O[0],z=O[1];n.useRef(0).current=m?1:0;var R=n.useRef(0);R.current=v.length;var P=n.useRef(!1);function B(){return H.apply(this,arguments)}function H(){return(H=w(x().mark((function e(){return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:p(o,i,t,(function(e){g(e),X(e.id)}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function U(){return(U=w(x().mark((function e(t){return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:g(t);case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function W(){return(W=w(x().mark((function e(){return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:g(void 0),h(void 0);case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function j(e,t){return G.apply(this,arguments)}function G(){return(G=w(x().mark((function e(t,n){return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:I(n.length>=R.current+50),S(n),z(!1);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function K(){return(K=w(x().mark((function e(t,n){var r,a,o;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:d===t&&(r=v?v.filter((function(e){return e.created!==n.created})):[],a=r.concat(n),o=St(a),S(o),A&&yt(333,"ce-message-list-"+d));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Y(){return(Y=w(x().mark((function e(t,n){var r,a,o;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t===d&&(r=v?v.filter((function(e){return e.id!==n.id})):[],a=[n].concat(r),o=St(a),S(o));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function q(){return(q=w(x().mark((function e(t,n){var r;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t===d&&(r=v?v.filter((function(e){return e.id!==n.id})):[],S(r));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function V(){return(V=w(x().mark((function e(){return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:B();case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function J(){return(J=w(x().mark((function e(){return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function X(e){return Z.apply(this,arguments)}function Z(){return(Z=w(x().mark((function e(t){return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:h(t),c(o,i,t,50,(function(e,n){j(e,n),yt(0,"ce-message-list-"+t)}));case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Q(){return(Q=w(x().mark((function e(t){var n;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=null==v?void 0:v.concat(t),S(n),u(o,i,d,t,(function(){})),setTimeout((function(){yt(333,"ce-message-list-"+d)}),100);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function $(){return($=w(x().mark((function e(){return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:_(!0);case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function ee(){return(ee=w(x().mark((function e(){return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:_(!1);case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function te(){return(te=w(x().mark((function e(){var t,n,r,a;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t="ce-message-list-"+d,n="ce-message-list-content-"+d,r=document.getElementById(n),a=r?r.clientHeight:0,d&&c(o,i,d,R.current+50,(function(e,r){j(e,r),setTimeout((function(){var e=document.getElementById(n);e&&s.animateScroll.scrollTo(e.clientHeight-a,{duration:333,containerId:t})}),1e3)}));case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function ne(){return(ne=w(x().mark((function e(){return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function re(){return(re=w(x().mark((function e(t,n){return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return n.useEffect((function(){P.current||(P.current=!0,B())}),[]),{onConnect:function(){return V.apply(this,arguments)},onAuthFail:function(){return J.apply(this,arguments)},onEditChat:function(e){return U.apply(this,arguments)},onDeleteChat:function(){return W.apply(this,arguments)},onGetMessages:j,onNewMessage:function(e,t){return K.apply(this,arguments)},onEditMessage:function(e,t){return Y.apply(this,arguments)},onDeleteMessage:function(e,t){return q.apply(this,arguments)},onIsTyping:function(e,t){return re.apply(this,arguments)},projectId:e,chatId:t,chatAccessKey:r,httpUrl:a,wsUrl:a&&a.replace("http","ws"),activeChatId:d,setActiveChatId:h,chat:m,messages:v,setMessages:S,peopleToInvite:C,setPeopleToInvite:E,hasMoreChats:M,setHasMoreChats:L,hasMoreMessages:N,setHasMoreMessages:I,isChatFeedAtBottom:A,setIsChatFeedAtBottom:_,isChatFeedLoading:D,setIsChatFeedLoading:z,onChatCardClick:X,onMessageLoaderShow:function(){return te.apply(this,arguments)},onMessageLoaderHide:function(){return ne.apply(this,arguments)},onBottomMessageShow:function(){return $.apply(this,arguments)},onBottomMessageHide:function(){return ee.apply(this,arguments)},onMessageFormSubmit:function(e){return Q.apply(this,arguments)}}};
//# sourceMappingURL=react-chat-engine-advanced.cjs.production.min.js.map
